# SPDX-License-Identifier: GPL-3.0-or-later
#
# Copyright (C) 2018 Khusika Dhamar Gusti (khusika)
#
# Ramdisk for khusika's kernel

on init
    #Zram configs
    write /sys/block/zram0/reset 1
    write /sys/block/zram0/comp_algorithm lz4
    write /sys/block/zram0/max_comp_streams 4
    write /sys/block/zram0/disksize 1073741824
    mkswap /dev/block/zram0
    swapon /dev/block/zram0 -p 32758

on post-fs-data
    # Boot time fs tune
    write /sys/block/mmcblk0/queue/scheduler bfq
    write /sys/block/mmcblk0/queue/iostats 0
    write /sys/block/mmcblk0/queue/iosched/slice_idle 0
    write /sys/block/mmcblk0/queue/read_ahead_kb 2048
    write /sys/block/mmcblk0/queue/nr_requests 256
    write /sys/block/mmcblk0/queue/add_random 0

on property:sys.boot_completed=1
    # according to Qcom this legacy value improves first launch latencies
    # stock value is 512k
    setprop dalvik.vm.heapminfree 2m

    write /proc/sys/vm/swappiness 100
    write /sys/module/lowmemorykiller/parameters/minfree "18432,23040,27648,32256,36864,46080"
    write /proc/sys/net/ipv4/tcp_congestion_control westwood

on property:init.svc.qcom-post-boot=stopped
    write /sys/block/mmcblk0/queue/read_ahead_kb 512
